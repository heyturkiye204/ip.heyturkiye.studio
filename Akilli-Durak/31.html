<!DOCTYPE html>
<html lang="tr">
<head>
    <title> Sivas Belediyesi Akıllı Durak </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
</head>
<body>
    <input name="__RequestVerificationToken" type="hidden" value="CfDJ8CuTDxpAKRRDkym3PI6DY8jxg-_h669KraOdeiUa3B1lMB2_Wi4fk-eQ2C5KWqK43rHXA7YF8Mfj4ZIoRlcQn7KUlYNbQO5J4XoJfxxtQNF_OZUFjm15j0ny26jwDKLviLF0LM0UPrNXRRD9ZSxK6lk" />
    <div class="container-fluid text-center" style="background-color: #f7f7f7;font-family:Roboto">
        <nav class="navbar fixed-top navbar-dark" style="overflow:hidden;">
            <div class="card w-100" style="background: #f7f7f7;padding: 5px;box-shadow: 0px 8px 20px 0px rgba(0, 0, 0, 0.15);border-radius: 10px;">
                
                <table class="card-body table table-resposive">
                    <thead>
                        <tr>
                            <th id="tarih" style="text-align:center;font-size:2vw;width:25%;color:darkblue"></th>
                            <th style="text-align:center;font-size:2vw;width:50%;color:darkblue">M&#x130;MAR S&#x130;NAN SA&#x11E;LIK OCA&#x11E;I</th>
                            <th id="saat" style="text-align:center;font-size:2vw;width:25%;color:darkblue"></th>
                        </tr>
                    </thead>

                </table>
            </div>
            
            
        </nav>
        <div class="row" style="margin-top:10vh;">
            <div class="col-12" style="overflow:auto;">
                <div class="card">

                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th style="text-align:center;font-size:2.5vw;">PLAKA</th>
                                    <th style="text-align:center;font-size:2.5vw;">HAT KODU</th>
                                    <th style="text-align:center;font-size:2.5vw;">HAT ADI</th>
                                    <th style="text-align:center;font-size:2.5vw;">SÜRE</th>
                                </tr>
                            </thead>
                            <tbody id="burayayaz">

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        

        
        
        
        








        <div class="footer bg-info" style="text-align:center;text-decoration-color:white;position:fixed;bottom:0px;width:100%; left:0px;">

            <small>Sayın yolcularımız; ekran üzerindeki dakika verilerimiz tahminidir.</small><br/>
            
            
            <small>ÇAĞRI MERKEZİ : 444 58 44</small><br />
            <small>ÇIKIŞ AMİRLİĞİ : 549 441 0 346</small>

            <a href="/ulasim/index" class="btn btn-danger btn-lg btn-block w-100" role="button" aria-pressed="true">Ana Sayfa</a>

        </div>
        
    </div>

    <script src="/js/jquery.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    
    
    <script>
        function tekrarlak() {

            var token = $('input[name="__RequestVerificationToken"]').val();

            var cols = { drkID: 31, __RequestVerificationToken: token };

            $.ajax({
                type: "POST",
                url: 'https://ulasim.sivas.bel.tr/Akilli-Durak/durakTekrar',
                data: cols,
                success: function (msg) {
                    
                    const date = new Date();
                    let currentDay = String(date.getDate()).padStart(2, '0');
                    let currentMonth = String(date.getMonth() + 1).padStart(2, "0");
                    let currentYear = date.getFullYear();
                    let currentTime = String(date.getHours()).padStart(2, '0');
                    let currentminute = String(date.getMinutes()).padStart(2, '0'); 
                    var trh = document.getElementById("tarih");
                    trh.innerHTML = currentDay + '-' + currentMonth + '-' + currentYear;
                    var sat = document.getElementById("saat");
                    sat.innerHTML = currentTime + ':' + currentminute;
                    var myArr = [];
                    var datasayi = msg.length;
                    $("#burayayaz").empty();
                    for (i = 0; i < (datasayi); i++) {
                         
                        _renk = msg[i].renk;
                        _plk = msg[i].plaka;
                        _hk = msg[i].hatkod;
                        _ha = msg[i].hatAd;
                        _yazilacak = msg[i].sure;
                        _clr = msg[i].textrenk;
                        myArr.push({ renk: _renk, plk: _plk, kod: _hk, ad: _ha, sur: _yazilacak, colorr: _clr });


                    }
                    myArr.sort(function (val1, val2) {
                        if (val1.sur < val2.sur) {
                            return -1;
                        } else {
                            return 1;
                        }
                    });

                    sayy = myArr.length;
                    for (i = 0; i < sayy; i++) {


                        trr = document.createElement("tr");
                        trr.style.backgroundColor = myArr[i].renk;
                        trr.style.color = myArr[i].colorr;
                        td1 = document.createElement("td");
                        td1.style.textAlign = "center";
                        td1.style.fontSize = "2.5vw";
                        td1.innerHTML = myArr[i].plk;
                        td2 = document.createElement("td");
                        td2.style.textAlign = "center";
                        td2.style.fontSize = "2.5vw";
                        td2.innerHTML = myArr[i].kod;
                        td3 = document.createElement("td");
                        td3.style.fontSize = "2.5vw";
                        td3.innerHTML = myArr[i].ad;
                        td4 = document.createElement("td");
                        td4.style.textAlign = "center";
                        td4.style.fontSize = "2.5vw";
                        td4.innerHTML = myArr[i].sur;
                        trr.appendChild(td1);
                        trr.appendChild(td2);
                        trr.appendChild(td3);
                        trr.appendChild(td4);
                        document.getElementById("burayayaz").appendChild(trr);

                    }

                    aracbilgitimeout = setTimeout("tekrarlak()", 20000);

                },
                failure: function (response) {

                    aracbilgitimeout = setTimeout("tekrarlak()", 20000);
                },
                error: function (response) {
                    aracbilgitimeout = setTimeout("tekrarlak()", 20000);
                }
            });
        };
        tekrarlak();
    </script>
</body>
</html>
